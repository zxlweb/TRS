/**
 * @fileOverview stub server
 * @author Max
 */
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var express = require("express");
var fs = require("fs");
var path = require("path");
var jr = require("../utils/json-result");
var router = express.Router();
exports.router = router;
router.all('*', function (req, res, next) {
    res.json(handleStubReq(req.path));
});
function handleStubReq(reqPath) {
    var stubFilePath = path.join(process.cwd(), __STUB_SERVER_FILE_DIR__, reqPath.substr(1).split('/').join('.') + '.json');
    console.log("visit stub file " + stubFilePath);
    var content;
    try {
        content = JSON.parse(fs.readFileSync(stubFilePath, { encoding: 'utf8' }));
    }
    catch (e) {
        content = jr.error('404 Not Found');
    }
    return content;
}
exports.handleStubReq = handleStubReq;
